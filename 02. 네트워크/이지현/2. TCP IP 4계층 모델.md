# TCP/IP 4계층 모델

## 1. 계층 구조

- 애플리케이션 계층
- 전송 계층
- 인터넷 계층
- 링크 계층

### 1-1. 애플리케이션 계층

FTP, HTTP, SSH, SMTP, DNS 등 응용 프로그램이 사용되는 프로토콜 계층

### 1-2. 전송 계층

송신자와 수신자를 연결하는 통신 서비스 제공

연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어 제공

- **TCP** : 패킷 사이 순서를 보장하고 연결지향 프로토콜 사용
  - '가상회선 패킷 교환 방식' 사용
- **UDP** : 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 데이터만 제공
  - '데이터그램 패킷 교환 방식' 사용

#### > 가상회선 패킷 교환 방식

각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 '순서대로' 도착하는 방식을 말함

#### > 데이터그램 패킷 교환 방식

패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 '순서가 다를 수' 있는 방식

#### > TCP 연결 성립 과정

TCP 는 신뢰성을 확보할 때 `3-way handshake` 라는 작업 진행

1. **SYN 단계**
2. **SYN + ACK 단계**
3. **ACK 단계**

`3-way handshake` 이후 신뢰성이 구축되고 데이터 전송 시작

#### > TCP 연결 해제 과정

연결을 해제할 때는 `4-way handshake` 과정 발생

지연 패킷 등의 문제점을 해결하기 위해 소켓이 바로 소멸되지 않고 일정 시간 유지되는 **TIME_WAIT** 상태가 있음

### 1-3. 인터넷 계층

장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층

IP, ARP, ICMP 등이 있으며 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달

### 1-4. 링크 계층

전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 '규칙'을 정하는 계층

#### > 유선 LAN

IEEE802.3 프로토콜을 따름

**전이중화 통신** 사용

- 양쪽 장치가 동시에 송수신할 수 있는 방식을 말함
- 송신로와 수신로로 나눠서 데이터를 주고받음

유선 LAN 을 이루는 케이블

- 트위스트 페어 케이블
- 광섬유 케이블

#### > 무선 LAN

IEEE802.11 프로토콜을 따름

**반이중화 통신** 사용

- 양쪽 장치는 서로 통신할 수 있지만,
- 동시에 통신할 수 없으며 한 번에 한 방향만 통신

**CSMA/CA**

- 데이터를 보내기 전에 사전에 가능한 한 충돌을 방지하는 방식

**무선 LAN을 이루는 주파수**

- 와이파이
- BSS(Basic Service Set)
- ESS(Extended Service Set)

#### > 이더넷 프레임

데이터 링크 계층은 이더넷 프레임을 통해 전달받은 데이터의 에러를 검출하고 캡슐화

### 1-5. 계층 간 데이터 송수신 과정

#### > 캡슐화 과정

상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정

#### > 비캡슐화 과정

하위 계층에서 상위 계층으로 가며 각 계층의 헤더 부분을 제거하는 과정

## 2. PDU (Protocol Data Unit)

네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위

- **헤더**: 제어 관련 정보
- **페이로드**: 데이터
  - **애플리케이션 계층**: 메시지
  - **전송 계층**: 세그먼트(TCP), 데이터그램(UDP)
  - **인터넷 계층**: 패킷
  - **링크 계층**: 프레임(데이터 링크 계층), 비트(물리 계층)
