## 2. 메모리

### 메모리 계층

- 레지스터 : CPU 안에 있는 작은 메모리로 휘발성, 속도가 가장 빠르며 기억 용량이 가장 적다
- 캐시 : L1, L2 캐시를 지칭하며 휘발성, 속도가 빠르며 기억 용량이 적다. 데이터를 미리 복사하는 임시 저장소이며 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리이다.
- 주기억장치(RAM) : 휘발성, 속도는 보통이며 기억 용량이 보통이다.
- 보조기억장치 : HDD, SDD를 일컬으며 비휘발성, 속도 낮음, 기억 용량이 많다.

- 시간 지역성 : 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성 : 최근 접근한 데이터를 이루고 있는 공간이나 그 가까운 공간에 접근하려는 특성

캐시에서 원하는 데이터를 찾는다면 캐시히트라고 하며, 해당 데이터가 캐시에 없다면 주메모리로 가서 데이터를 찾아오는 것을 캐시미스라고 한다.
캐시매핑이란 캐시가 히트되기 위해 매핑하는 방법이며 CPU의 레지스터와 주 메모리간에 데이터를 주고받을 때를 기반으로 직접 매핑, 연관 매핑, 집합 연관 매핑으로 분류된다.

### 메모리 관리

- 가상 메모리 : 컴퓨터가 실제로 이용 가능한 메모리 자원을 추상화하여 이를 사용하는 사용자들에게 매우 큰 메모리로 보이게 만드는 것. 가상 주소와 실제 주소를 두고 메모리관리장치에 의해 가상 주소는 실제 주소로 변환된다.
  가상 메모리에는 존재하지만 실제 모미리에는 현재 없는 데이터나 코드에 접근할 경우 페이지 폴트가 발생한다. 이때 메모리에서 사용하지 않는 영역을 하드디스크로 옮기고 하드디스크의 일부분을 메모리처럼 불러와 쓰는 것을 스와핑이라고 한다.
  스레싱은 메모리 페이지 폴트율이 높은 것을 의미하며 스레싱을 해결하기 위해 메모리를 늘리거나 HDD를 SSD로 바꾸거나 운영체제에서 작업 세트와 PFF를 이용할 수 있다.
  작업 세트는 지역성을 통해 페이지 집합을 만들어서 미리 메모리에 로드하는 것이다.
  PFF는 페이지 폴트 빈도를 조절하는 방법으로 상한선과 하한선을 만드는 방법이다.

메모리 할당은 연속 할당과 불연속 할당으로 나뉜다.
연속 할당은 메모리에 연속적으로 공간을 할당하는 것을 말한다. 메모리를 미리 나누어 관리하는 고정 분할 방식과 매 시점 프로그램의 크기에 맞게 메모리를 분할하여 사용하는 가변 분할 방식이 있다.
고정 분할 방식은 융통성이 없으며 내부 단편화가 발생한다. 가변 분할 방식은 내부 단편화는 발생하지 않고 외부 단편화는 발생할 수 있다.
불연속 할당은 연속적으로 할당하지 않으며 페이징 기법이 있다. 메모리를 동일한 크기의 페이지로 나누고 프로그램마다 페이지 테이블을 두어 메모리에 프로그램을 할당한ㄷ. 페이징 기법 외에 세그멘테이션, 페이지드 세그멘테이션이 있다.
페이징은 동일한 크기의 페이지 단위로 나누어 메모리의 서로 다른 위치에 프로세스를 할당한다. 크기가 균일하지 않은 문제가 없어지지만 주소 변환이 복잡해진다.
새그멘테이션은 페이지 단위가 아닌 의미 단위인 세그먼트로 나누는 방식이다. 코드와 데이터로 나누거나 코드 내의 작은 함수를 세그먼트로 놓고 나눌 수도 있다. 공유와 보안 츠겸ㄴ에서 장점을 가지지만 홀 크기가 균일하지 않는 단점이 있다.
페이지드 세그멘테이션은 프로그램을 의미 단위인 세그먼트로 나눠 임의의 길이가 아닌 동일한 크기의 페이지 단위로 나누는 것이다.

페이지 교체 알고리즘 중 오프라인 알고리즘은 먼 미래에 참조되는 페이지와 현재 할당하는 페이지를 바꾸는 알고리즘이지만 미래에 사용되는 프로세스를 알수는 없다. 다른 알고리즘과의 성능 비교에 대한 상한기준을 제공하기 위해 사용된다.

- FIFO : 가장 먼저 온 페이지를 교체 영역에 가장 먼저 놓는 방법
- LRU : 참조가 가장 오래된 페이지를 바꾼다. 오래된 것을 파악하기 위해 계수기, 스택을 두어야한다.
- NUR : clock 알고리즘이라고 하며 0과 1을 가진 비트를 둔다. 1은 최근에 참조되었고 0은 참조되지 않음을 의미한다. 시계 방향으로 돌면서 0을 찾고 0을 찾은 순간 해당 프로세스를 교체하고, 해당 부분을 1로 바꾸는 알고리즘이다.
- LFU : 가장 참조 횟수가 적은 페이지를 교체한다.
